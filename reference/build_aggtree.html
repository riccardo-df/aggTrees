<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Nonparametric data-driven approach to discovering heterogeneous subgroups in a selection-on-observables framework.
The approach constructs a sequence of groupings, one for each level of granularity. Groupings are nested and
feature an optimality property. For each grouping, we obtain point estimation and standard errors for the group average
treatment effects (GATEs). Additionally, we assess whether systematic heterogeneity is found by testing the hypotheses
that the differences in the GATEs across all pairs of groups are zero. Finally, we investigate the driving mechanisms of
effect heterogeneity by computing the average characteristics of units in each group."><title>Aggregation Trees — build_aggtree • aggTrees</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregation Trees — build_aggtree"><meta property="og:description" content="Nonparametric data-driven approach to discovering heterogeneous subgroups in a selection-on-observables framework.
The approach constructs a sequence of groupings, one for each level of granularity. Groupings are nested and
feature an optimality property. For each grouping, we obtain point estimation and standard errors for the group average
treatment effects (GATEs). Additionally, we assess whether systematic heterogeneity is found by testing the hypotheses
that the differences in the GATEs across all pairs of groups are zero. Finally, we investigate the driving mechanisms of
effect heterogeneity by computing the average characteristics of units in each group."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">aggTrees</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/aggTrees-vignette.html">Aggregation Trees</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Aggregation Trees</h1>
      
      <div class="d-none name"><code>build_aggtree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Nonparametric data-driven approach to discovering heterogeneous subgroups in a selection-on-observables framework.
The approach constructs a sequence of groupings, one for each level of granularity. Groupings are nested and
feature an optimality property. For each grouping, we obtain point estimation and standard errors for the group average
treatment effects (GATEs). Additionally, we assess whether systematic heterogeneity is found by testing the hypotheses
that the differences in the GATEs across all pairs of groups are zero. Finally, we investigate the driving mechanisms of
effect heterogeneity by computing the average characteristics of units in each group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build_aggtree</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">D</span>,</span>
<span>  <span class="va">X</span>,</span>
<span>  honest_frac <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"aipw"</span>,</span>
<span>  scores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  is_honest <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">inference_aggtree</span><span class="op">(</span><span class="va">object</span>, <span class="va">n_groups</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>y</dt>
<dd><p>Outcome vector.</p></dd>


<dt>D</dt>
<dd><p>Treatment vector.</p></dd>


<dt>X</dt>
<dd><p>Covariate matrix (no intercept).</p></dd>


<dt>honest_frac</dt>
<dd><p>Fraction of observations to be allocated to honest sample.</p></dd>


<dt>method</dt>
<dd><p>Either <code>"raw"</code> or <code>"aipw"</code>, controls how node predictions are computed.</p></dd>


<dt>scores</dt>
<dd><p>Optional, vector of scores to be used in computing node predictions. Useful to save computational time if scores have already been estimated. Ignored if <code>method == "raw"</code>.</p></dd>


<dt>cates</dt>
<dd><p>Optional, estimated CATEs. If not provided by the user, CATEs are estimated internally via a <code><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">causal_forest</a></code>.</p></dd>


<dt>is_honest</dt>
<dd><p>Logical vector denoting which observations belong to the honest sample. Required only if the <code>cates</code> argument is used.</p></dd>


<dt>...</dt>
<dd><p>Further arguments from <code><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html" class="external-link">rpart.control</a></code>.</p></dd>


<dt>object</dt>
<dd><p>An <code>aggTrees</code> object.</p></dd>


<dt>n_groups</dt>
<dd><p>Number of desired groups.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>build_aggtree</code> returns an <code>aggTrees</code> object.<br></p>



<p><code>inference_aggtree</code> returns an <code>aggTrees.inference</code> object, which in turn contains the <code>aggTrees</code> object used
in the call.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Aggregation trees are a three-step procedure. First, the conditional average treatment effects (CATEs) are estimated using any
estimator. Second, a tree is grown to approximate the CATEs. Third, the tree is pruned to derive a nested sequence of optimal
groupings, one for each granularity level. For each level of granularity, we can obtain point estimation and inference about
the GATEs.<br></p>
<p>To implement this methodology, the user can rely on two core functions that handle the various steps.<br></p><div class="section">
<h3 id="constructing-the-sequence-of-groupings">Constructing the Sequence of Groupings<a class="anchor" aria-label="anchor" href="#constructing-the-sequence-of-groupings"></a></h3>


<p><code>build_aggtree</code> constructs the sequence of groupings (i.e., the tree) and estimate the GATEs in each node. The
GATEs can be estimated in several ways. This is controlled by the <code>method</code> argument. If <code>method == "raw"</code>, we
compute the difference in mean outcomes between treated and control observations in each node. This is an unbiased estimator
in randomized experiment. If <code>method == "aipw"</code>, we construct doubly-robust scores and average them in each node. This
is unbiased also in observational studies. Honest regression forests and 5-fold cross fitting are used to estimate the
propensity score and the conditional mean function of the outcome (unless the user specifies the argument <code>scores</code>).<br></p>
<p>The user can provide a vector of the estimated CATEs via the <code>cates</code> argument. If so, the user needs to specify a logical
vector to denote which observations belong to the honest sample. If honesty is not desired, <code>is_honest</code> must be a
vector of <code>FALSE</code>s. If no vector of CATEs is provided, these are estimated internally via a
<code><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">causal_forest</a></code>.<br></p>
</div>

<div class="section">
<h3 id="gates-estimation-and-inference">GATEs Estimation and Inference<a class="anchor" aria-label="anchor" href="#gates-estimation-and-inference"></a></h3>


<p><code>inference_aggtree</code> takes as input an <code>aggTrees</code> object constructed by <code>build_aggtree</code>. Then, for
the desired granularity level, chosen via the <code>n_groups</code> argument, it provides point estimation and standard errors for
the GATEs. Additionally, it performs some hypothesis testing to assess whether we find systematic heterogeneity and computes
the average characteristics of the units in each group to investigate the driving mechanisms.</p><div class="section">
<h4 id="point-estimates-and-standard-errors-for-the-gates">Point estimates and standard errors for the GATEs<a class="anchor" aria-label="anchor" href="#point-estimates-and-standard-errors-for-the-gates"></a></h4>


<p>GATEs and their standard errors are obtained by fitting an appropriate linear model. If <code>method == "raw"</code>, we estimate
via OLS the following:</p>
<p>$$Y_i = \sum_{l = 1}^{|T|} L_{i, l} \gamma_l + \sum_{l = 1}^{|T|} L_{i, l} D_i \beta_l + \epsilon_i$$</p>
<p>with <code>L_{i, l}</code> a dummy variable equal to one if the i-th unit falls in the l-th group, and |T| the
number of groups. If the treatment is randomly assigned, one can show that the betas identify the GATE of
each group. However, this is not true in observational studies due to selection into treatment. In this case, the user is
expected to use <code>method == "aipw"</code> when calling <code>build_aggtree</code>. In this case,
<code>inference_aggtree</code> uses the scores in the following regression:</p>
<p>$$score_i = \sum_{l = 1}^{|T|} L_{i, l} \beta_l + \epsilon_i$$</p>
<p>This way, betas again identify the GATEs. Regardless of <code>method</code>, standard errors are estimated via the Eicker-Huber-White
estimator.</p>
</div>

<div class="section">
<h4 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a></h4>


<p><code>inference_aggtree</code> uses the standard errors obtained by fitting the linear models above to test the hypotheses
that the GATEs are different across all pairs of leaves. Here, we adjust p-values to account for multiple hypotheses testing
using Holm's procedure.</p>
</div>

<div class="section">
<h4 id="average-characteristics">Average Characteristics<a class="anchor" aria-label="anchor" href="#average-characteristics"></a></h4>


<p><code>inference_aggtree</code> regresses each covariate on a set of dummies denoting group membership. This way, we get the
average characteristics of units in each leaf, together with a standard error. Leaves are ordered in increasing order of their
predictions (from most negative to most positive). Standard errors are estimated via the Eicker-Huber-White estimator.</p>
</div>


</div>

<div class="section">
<h3 id="caution-on-inference">Caution on Inference<a class="anchor" aria-label="anchor" href="#caution-on-inference"></a></h3>


<p>Regardless of the chosen <code>method</code>, both functions estimate the GATEs, the linear models, and the average characteristics
of units in each group using only observations in the honest sample. If the honest sample is empty (this happens because the
user either sets <code>honest_frac = 0</code> or passes a vector of <code>FALSE</code>s as <code>is_honest</code> when calling
<code>build_aggtree</code>), the same data used to construct the tree are used to estimate the above quantities. This is
fine for prediction but invalidates inference.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>R Di Francesco (2022). Aggregation Trees. CEIS Research Paper, 546. <a href="https://doi.org/10.2139/ssrn.4304256" class="external-link">doi:10.2139/ssrn.4304256</a>
.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.aggTrees.html">plot.aggTrees</a></code> <code><a href="print.aggTrees.inference.html">print.aggTrees.inference</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Riccardo Di Francesco</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Generate data.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1986</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">mu0</span> <span class="op">+</span> <span class="va">D</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu1</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Construct sequence of groupings. CATEs estimated internally.</span></span></span>
<span class="r-in"><span><span class="va">groupings</span> <span class="op">&lt;-</span> <span class="fu">build_aggtree</span><span class="op">(</span><span class="va">y</span>, <span class="va">D</span>, <span class="va">X</span>, method <span class="op">=</span> <span class="st">"aipw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, we can estimate the CATEs and pass them.</span></span></span>
<span class="r-in"><span><span class="va">splits</span> <span class="op">&lt;-</span> <span class="fu"><a href="sample_split.html">sample_split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, training_frac <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">training_idx</span> <span class="op">&lt;-</span> <span class="va">splits</span><span class="op">$</span><span class="va">training_idx</span></span></span>
<span class="r-in"><span><span class="va">honest_idx</span> <span class="op">&lt;-</span> <span class="va">splits</span><span class="op">$</span><span class="va">honest_idx</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y_tr</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">training_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">D_tr</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">training_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">X_tr</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">training_idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y_hon</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">[</span><span class="va">honest_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">D_hon</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">honest_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">X_hon</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">honest_idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/grf-labs/grf" class="external-link">grf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">causal_forest</a></span><span class="op">(</span><span class="va">X_tr</span>, <span class="va">y_tr</span>, <span class="va">D_tr</span><span class="op">)</span> <span class="co"># Use training sample.</span></span></span>
<span class="r-in"><span><span class="va">cates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest</span>, <span class="va">X</span><span class="op">)</span><span class="op">$</span><span class="va">predictions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">groupings</span> <span class="op">&lt;-</span> <span class="fu">build_aggtree</span><span class="op">(</span><span class="va">y</span>, <span class="va">D</span>, <span class="va">X</span>, method <span class="op">=</span> <span class="st">"aipw"</span>, cates <span class="op">=</span> <span class="va">cates</span>,</span></span>
<span class="r-in"><span>                           is_honest <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">honest_idx</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We have compatibility with generic S3-methods.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honest estimates: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rpart::rpart(formula = cates ~ ., data = data.frame(cates = cates[training_idx], </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     X_tr), method = "anova", model = TRUE, control = rpart::rpart.control(...))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n= 500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           CP nsplit  rel error     xerror        xstd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.83058853      0 1.00000000 1.00771257 0.030825922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.09344721      1 0.16941147 0.17190900 0.007887736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.04000645      2 0.07596426 0.07819024 0.006270086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.01000000      3 0.03595781 0.03824223 0.002039752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variable importance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2 x3 x1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92  4  4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 1: 500 observations,    complexity param=0.8305885</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-0.06414735, MSE=1.060902 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   left son=2 (230 obs) right son=3 (270 obs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Primary splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x2 &lt; -0.07518198 to the left,  improve=0.83058850, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; -0.207075   to the left,  improve=0.01980168, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; -0.9775529  to the left,  improve=0.01388725, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Surrogate splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; -0.983981   to the left,  agree=0.560, adj=0.043, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; -0.207075   to the left,  agree=0.558, adj=0.039, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 2: 230 observations,    complexity param=0.04000645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-0.789146, MSE=0.1300297 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   left son=4 (169 obs) right son=5 (61 obs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Primary splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x2 &lt; -0.4126471  to the left,  improve=0.70958610, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; 0.1943697   to the left,  improve=0.09276113, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; -0.61261    to the left,  improve=0.01080878, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Surrogate splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; -1.889246   to the right, agree=0.743, adj=0.033, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; 2.095613    to the left,  agree=0.739, adj=0.016, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 3: 270 observations,    complexity param=0.09344721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=0.5839575, MSE=0.2220655 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   left son=6 (122 obs) right son=7 (148 obs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Primary splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x2 &lt; 0.5478927   to the left,  improve=0.82673610, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; 0.4544582   to the left,  improve=0.03798430, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; 1.302729    to the left,  improve=0.01857262, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Surrogate splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; -1.130523   to the left,  agree=0.593, adj=0.098, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; 0.09411584  to the left,  agree=0.570, adj=0.049, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 4: 169 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-1.055781, MSE=0.02613966 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 5: 61 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=0.1095144, MSE=0.06996318 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 6: 122 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-0.08652797, MSE=0.03845698 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 7: 148 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=1.19614, MSE=0.03849155 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honest estimates: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> node), split, n, deviance, yval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       * denotes terminal node</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1) root 500 530.451100 -0.06414735  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2) x2&lt; -0.07518198 230  29.906820 -0.78914600  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4) x2&lt; -0.4126471 169   4.417603 -1.05578100 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5) x2&gt;=-0.4126471 61   4.267754  0.10951440 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3) x2&gt;=-0.07518198 270  59.957670  0.58395750  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6) x2&lt; 0.5478927 122   4.691751 -0.08652797 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7) x2&gt;=0.5478927 148   5.696749  1.19614000 *</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">)</span> <span class="co"># Try also setting 'sequence = TRUE'.</span></span></span>
<span class="r-plt img"><img src="build_aggtree-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To predict, do the following.</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="subtree.html">subtree</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">$</span><span class="va">tree</span>, cv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Select by cross-validation.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1           2           3           4           5           6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -1.05578145  1.19613984  1.19613984 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           7           8           9          10          11          12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145 -0.08652797  0.10951435 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          13          14          15          16          17          18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -0.08652797  1.19613984 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          19          20          21          22          23          24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797 -1.05578145 -0.08652797  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          25          26          27          28          29          30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  1.19613984 -1.05578145 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          31          32          33          34          35          36 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  1.19613984  1.19613984 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          37          38          39          40          41          42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -1.05578145  0.10951435 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          43          44          45          46          47          48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  1.19613984 -0.08652797 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          49          50          51          52          53          54 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  0.10951435 -1.05578145  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          55          56          57          58          59          60 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145  1.19613984  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          61          62          63          64          65          66 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145 -1.05578145  0.10951435 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          67          68          69          70          71          72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984  1.19613984 -0.08652797 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          73          74          75          76          77          78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  0.10951435  1.19613984  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          79          80          81          82          83          84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145  1.19613984  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          85          86          87          88          89          90 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  0.10951435 -0.08652797  1.19613984 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          91          92          93          94          95          96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797 -0.08652797 -0.08652797  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          97          98          99         100         101         102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984  1.19613984  1.19613984 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         103         104         105         106         107         108 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984 -0.08652797  1.19613984 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         109         110         111         112         113         114 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -0.08652797 -1.05578145 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         115         116         117         118         119         120 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  1.19613984 -0.08652797 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         121         122         123         124         125         126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -0.08652797  1.19613984 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         127         128         129         130         131         132 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  0.10951435  0.10951435 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         133         134         135         136         137         138 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  1.19613984  1.19613984 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         139         140         141         142         143         144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  1.19613984  1.19613984  0.10951435  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         145         146         147         148         149         150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984 -0.08652797  1.19613984  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         151         152         153         154         155         156 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984  1.19613984 -0.08652797 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         157         158         159         160         161         162 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  1.19613984 -0.08652797  1.19613984  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         163         164         165         166         167         168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984  0.10951435 -0.08652797 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         169         170         171         172         173         174 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797  1.19613984  1.19613984 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         175         176         177         178         179         180 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  1.19613984 -1.05578145  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         181         182         183         184         185         186 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  1.19613984 -1.05578145  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         187         188         189         190         191         192 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797  0.10951435 -0.08652797  0.10951435  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         193         194         195         196         197         198 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -1.05578145 -0.08652797  0.10951435 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         199         200         201         202         203         204 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  1.19613984 -0.08652797 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         205         206         207         208         209         210 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  1.19613984 -0.08652797  1.19613984 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         211         212         213         214         215         216 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -0.08652797 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         217         218         219         220         221         222 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -1.05578145  0.10951435  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         223         224         225         226         227         228 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  1.19613984 -1.05578145  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         229         230         231         232         233         234 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -1.05578145 -1.05578145  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         235         236         237         238         239         240 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  0.10951435  1.19613984 -1.05578145 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         241         242         243         244         245         246 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -1.05578145  0.10951435 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         247         248         249         250         251         252 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145 -0.08652797 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         253         254         255         256         257         258 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984 -0.08652797  0.10951435 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         259         260         261         262         263         264 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -1.05578145 -0.08652797 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         265         266         267         268         269         270 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -0.08652797  1.19613984 -0.08652797  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         271         272         273         274         275         276 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -1.05578145  1.19613984  1.19613984  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         277         278         279         280         281         282 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797 -1.05578145 -0.08652797 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         283         284         285         286         287         288 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -1.05578145  1.19613984 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         289         290         291         292         293         294 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145  0.10951435  0.10951435 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         295         296         297         298         299         300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984  1.19613984 -1.05578145  0.10951435 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         301         302         303         304         305         306 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -1.05578145 -1.05578145  1.19613984 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         307         308         309         310         311         312 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -0.08652797  0.10951435 -0.08652797  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         313         314         315         316         317         318 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  1.19613984 -1.05578145 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         319         320         321         322         323         324 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  1.19613984 -0.08652797 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         325         326         327         328         329         330 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -1.05578145  0.10951435 -1.05578145 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         331         332         333         334         335         336 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -1.05578145  1.19613984 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         337         338         339         340         341         342 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -1.05578145  1.19613984 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         343         344         345         346         347         348 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797 -0.08652797 -0.08652797 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         349         350         351         352         353         354 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -1.05578145  1.19613984  0.10951435  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         355         356         357         358         359         360 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  1.19613984 -1.05578145  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         361         362         363         364         365         366 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  0.10951435 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         367         368         369         370         371         372 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984  0.10951435  1.19613984  1.19613984  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         373         374         375         376         377         378 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797  1.19613984 -0.08652797 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         379         380         381         382         383         384 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -0.08652797  1.19613984 -0.08652797  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         385         386         387         388         389         390 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145  1.19613984  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         391         392         393         394         395         396 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  1.19613984  1.19613984 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         397         398         399         400         401         402 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984  1.19613984 -1.05578145  0.10951435 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         403         404         405         406         407         408 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  0.10951435 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         409         410         411         412         413         414 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  0.10951435  1.19613984 -0.08652797  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         415         416         417         418         419         420 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797  1.19613984  1.19613984  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         421         422         423         424         425         426 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  0.10951435 -1.05578145 -0.08652797  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         427         428         429         430         431         432 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -1.05578145 -0.08652797  1.19613984  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         433         434         435         436         437         438 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  0.10951435 -1.05578145 -1.05578145 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         439         440         441         442         443         444 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -1.05578145  0.10951435  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         445         446         447         448         449         450 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -1.05578145 -1.05578145  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         451         452         453         454         455         456 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  1.19613984 -0.08652797 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         457         458         459         460         461         462 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  0.10951435  1.19613984 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         463         464         465         466         467         468 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797 -1.05578145  0.10951435  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         469         470         471         472         473         474 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -0.08652797  0.10951435 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         475         476         477         478         479         480 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  1.19613984 -1.05578145 -1.05578145 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         481         482         483         484         485         486 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984  0.10951435 -1.05578145 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         487         488         489         490         491         492 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -0.08652797 -1.05578145 -1.05578145  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         493         494         495         496         497         498 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  1.19613984 -1.05578145  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         499         500         501         502         503         504 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  1.19613984  1.19613984 -1.05578145 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         505         506         507         508         509         510 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145  1.19613984 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         511         512         513         514         515         516 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797  1.19613984  1.19613984  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         517         518         519         520         521         522 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  0.10951435 -1.05578145 -1.05578145 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         523         524         525         526         527         528 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -1.05578145 -1.05578145 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         529         530         531         532         533         534 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  0.10951435  0.10951435 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         535         536         537         538         539         540 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984 -1.05578145 -0.08652797 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         541         542         543         544         545         546 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145  1.19613984  0.10951435  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         547         548         549         550         551         552 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -1.05578145  1.19613984 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         553         554         555         556         557         558 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -1.05578145 -0.08652797  1.19613984  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         559         560         561         562         563         564 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145  1.19613984 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         565         566         567         568         569         570 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  0.10951435  1.19613984 -1.05578145  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         571         572         573         574         575         576 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984 -0.08652797 -0.08652797  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         577         578         579         580         581         582 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -1.05578145  1.19613984  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         583         584         585         586         587         588 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  0.10951435 -0.08652797 -1.05578145 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         589         590         591         592         593         594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  0.10951435 -1.05578145 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         595         596         597         598         599         600 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145 -0.08652797  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         601         602         603         604         605         606 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984  1.19613984 -1.05578145  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         607         608         609         610         611         612 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -0.08652797  1.19613984 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         613         614         615         616         617         618 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -0.08652797 -1.05578145 -1.05578145 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         619         620         621         622         623         624 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984  1.19613984 -0.08652797  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         625         626         627         628         629         630 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984  1.19613984 -0.08652797 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         631         632         633         634         635         636 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -0.08652797  0.10951435 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         637         638         639         640         641         642 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  0.10951435  1.19613984 -0.08652797  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         643         644         645         646         647         648 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145  0.10951435 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         649         650         651         652         653         654 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  1.19613984  1.19613984  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         655         656         657         658         659         660 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984  1.19613984  1.19613984  0.10951435 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         661         662         663         664         665         666 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  0.10951435 -0.08652797  1.19613984  0.10951435 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         667         668         669         670         671         672 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -1.05578145 -0.08652797 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         673         674         675         676         677         678 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984 -1.05578145 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         679         680         681         682         683         684 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -1.05578145  1.19613984 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         685         686         687         688         689         690 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -0.08652797  1.19613984  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         691         692         693         694         695         696 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -0.08652797  1.19613984 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         697         698         699         700         701         702 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  1.19613984 -0.08652797 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         703         704         705         706         707         708 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -1.05578145 -0.08652797 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         709         710         711         712         713         714 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -0.08652797 -1.05578145  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         715         716         717         718         719         720 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  0.10951435 -1.05578145 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         721         722         723         724         725         726 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145 -1.05578145 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         727         728         729         730         731         732 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145  1.19613984 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         733         734         735         736         737         738 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -1.05578145 -0.08652797 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         739         740         741         742         743         744 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984  1.19613984  1.19613984 -0.08652797  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         745         746         747         748         749         750 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -1.05578145 -1.05578145  1.19613984 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         751         752         753         754         755         756 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  0.10951435 -0.08652797 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         757         758         759         760         761         762 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -0.08652797 -0.08652797 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         763         764         765         766         767         768 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  0.10951435 -0.08652797 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         769         770         771         772         773         774 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -1.05578145  1.19613984 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         775         776         777         778         779         780 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984 -1.05578145  0.10951435 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         781         782         783         784         785         786 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -0.08652797  0.10951435 -1.05578145  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         787         788         789         790         791         792 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  1.19613984 -0.08652797 -1.05578145 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         793         794         795         796         797         798 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  0.10951435 -0.08652797 -1.05578145 -0.08652797  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         799         800         801         802         803         804 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984 -1.05578145  1.19613984  1.19613984  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         805         806         807         808         809         810 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  1.19613984  0.10951435 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         811         812         813         814         815         816 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -1.05578145  1.19613984  1.19613984 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         817         818         819         820         821         822 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145 -1.05578145 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         823         824         825         826         827         828 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797  0.10951435  1.19613984 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         829         830         831         832         833         834 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -0.08652797 -0.08652797  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         835         836         837         838         839         840 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -0.08652797  1.19613984 -0.08652797  0.10951435 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         841         842         843         844         845         846 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797  0.10951435 -0.08652797 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         847         848         849         850         851         852 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -0.08652797  1.19613984  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         853         854         855         856         857         858 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -0.08652797  1.19613984 -1.05578145 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         859         860         861         862         863         864 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -0.08652797  1.19613984 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         865         866         867         868         869         870 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  0.10951435  1.19613984 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         871         872         873         874         875         876 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -0.08652797 -1.05578145 -0.08652797  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         877         878         879         880         881         882 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  1.19613984  1.19613984 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         883         884         885         886         887         888 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  0.10951435  0.10951435 -0.08652797  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         889         890         891         892         893         894 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -0.08652797 -1.05578145  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         895         896         897         898         899         900 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  1.19613984  0.10951435 -1.05578145  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         901         902         903         904         905         906 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -0.08652797  1.19613984  0.10951435 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         907         908         909         910         911         912 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -1.05578145  0.10951435  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         913         914         915         916         917         918 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  1.19613984 -0.08652797 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         919         920         921         922         923         924 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145  1.19613984 -0.08652797 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         925         926         927         928         929         930 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145  1.19613984 -1.05578145 -0.08652797 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         931         932         933         934         935         936 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984  0.10951435 -1.05578145 -0.08652797  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         937         938         939         940         941         942 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145  0.10951435 -1.05578145 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         943         944         945         946         947         948 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145 -1.05578145 -0.08652797  1.19613984 -1.05578145  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         949         950         951         952         953         954 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  0.10951435 -1.05578145  1.19613984  1.19613984  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         955         956         957         958         959         960 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -1.05578145 -1.05578145  1.19613984  1.19613984 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         961         962         963         964         965         966 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984  1.19613984  0.10951435  0.10951435  1.19613984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         967         968         969         970         971         972 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435 -1.05578145 -0.08652797 -0.08652797 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         973         974         975         976         977         978 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.05578145  1.19613984 -1.05578145  1.19613984 -1.05578145 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         979         980         981         982         983         984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797  1.19613984 -1.05578145 -0.08652797 -1.05578145 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         985         986         987         988         989         990 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.19613984 -0.08652797 -1.05578145 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         991         992         993         994         995         996 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.10951435  1.19613984  1.19613984 -0.08652797  1.19613984 -0.08652797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         997         998         999        1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.08652797 -1.05578145 -0.08652797 -1.05578145 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Inference with 4 groups.</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">inference_aggtree</span><span class="op">(</span><span class="va">groupings</span>, n_groups <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">model</span><span class="op">)</span> <span class="co"># Coefficient of leafk is GATE in k-th leaf.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimatr::lm_robust(formula = scores ~ 0 + leaf, data = data.frame(scores = scores, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     leaf = leaves), se_type = "HC1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard error type:  HC1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper  DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf1 -1.05578     0.1551 -6.8089 2.851e-11  -1.3604  -0.7511 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf2 -0.08653     0.1873 -0.4619 6.444e-01  -0.4546   0.2815 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf3  0.10951     0.2805  0.3904 6.964e-01  -0.4416   0.6606 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf4  1.19614     0.1994  5.9984 3.846e-09   0.8043   1.5879 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.1476 ,	Adjusted R-squared:  0.1407 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 20.68 on 4 and 496 DF,  p-value: 8.936e-16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">gates_diff_pairs</span><span class="op">$</span><span class="va">gates_diff</span> <span class="co"># GATEs differences.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           leaf1     leaf2    leaf3 leaf4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf1        NA        NA       NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf2 0.9692535        NA       NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf3 1.1652958 0.1960423       NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf4 2.2519213 1.2826678 1.086625    NA</span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">gates_diff_pairs</span><span class="op">$</span><span class="va">holm_pvalues</span> <span class="co"># leaves 1-2 not statistically different.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]        [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]           NA           NA          NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 3.094972e-04           NA          NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 9.180598e-04 5.613635e-01          NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 5.617761e-17 1.784486e-05 0.003377922   NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## LATEX.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span>, table <span class="op">=</span> <span class="st">"diff"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \begingroup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \setlength{\tabcolsep}{8pt}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \renewcommand{\arraystretch}{1.2}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \begin{table}[b!]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \centering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{adjustbox}{width = 0.85\textwidth}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{tabular}{@{\extracolsep{5pt}}l c c c c}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; \textit{Leaf 1} &amp; \textit{Leaf 2} &amp; \textit{Leaf 3} &amp; \textit{Leaf 4} \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[2pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \multirow{2}{*}{GATEs} &amp; -1.056 &amp; -0.087 &amp; 0.11 &amp; 1.196 \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; [-1.36, -0.752] &amp; [-0.454, 0.28] &amp; [-0.439, 0.659] &amp; [0.806, 1.586] \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[2pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 1} &amp; NA &amp; NA &amp; NA &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (NA) &amp; (NA) &amp; (NA) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 2} &amp; 0.969 &amp; NA &amp; NA &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (0) &amp; (NA) &amp; (NA) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 3} &amp; 1.165 &amp; 0.196 &amp; NA &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (0.001) &amp; (0.561) &amp; (NA) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 4} &amp; 2.252 &amp; 1.283 &amp; 1.087 &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (0) &amp; (0) &amp; (0.003) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[3pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{tabular}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{adjustbox}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \caption{Point estimates and $95\%$ confidence intervals for the GATEs. Leaves are sorted in increasing order of the GATEs. Additionally, differences in the GATEs across all pairs of leaves are displayed. p-values to test the null hypothesis that a single difference is zero are adjusted using Holm's procedure and reported in parenthesis under each point estimate.}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \label{table:differences.gates}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{table}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \endgroup </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span>, table <span class="op">=</span> <span class="st">"avg_char"</span><span class="op">)</span><span class="co"># }</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \begingroup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \setlength{\tabcolsep}{8pt}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \renewcommand{\arraystretch}{1.1}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \begin{table}[b!]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \centering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{adjustbox}{width = 1\textwidth}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{tabular}{@{\extracolsep{5pt}}l c c c c c c c c }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; \multicolumn{2}{c}{\textit{Leaf 1}} &amp; \multicolumn{2}{c}{\textit{Leaf 2}} &amp; \multicolumn{2}{c}{\textit{Leaf 3}} &amp; \multicolumn{2}{c}{\textit{Leaf 4}} \\\cmidrule{2-3} \cmidrule{4-5} \cmidrule{6-7} \cmidrule{8-9} </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; Mean &amp; (S.D.) &amp; Mean &amp; (S.D.) &amp; Mean &amp; (S.D.) &amp; Mean &amp; (S.D.) \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[2pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \texttt{x1} &amp; 0.025 &amp; (0.072) &amp; 0.035 &amp; (0.096) &amp; -0.179 &amp; (0.133) &amp; 0.086 &amp; (0.082) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \texttt{x2} &amp; -1.131 &amp; (0.042) &amp; 0.209 &amp; (0.016) &amp; -0.237 &amp; (0.014) &amp; 1.101 &amp; (0.04) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \texttt{x3} &amp; -0.009 &amp; (0.071) &amp; 0.088 &amp; (0.092) &amp; -0.066 &amp; (0.13) &amp; -0.047 &amp; (0.092) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[3pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{tabular}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{adjustbox}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \caption{Average characteristics of units in each leaf, obtained by regressing each covariate on a set of dummies denoting leaf membership. Standard errors are estimated via the Eicker-Huber-White estimator. Leaves are sorted in increasing order of the GATEs.}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \label{table:average.characteristics.leaves}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{table}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \endgroup </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Riccardo Di Francesco.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

