<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Aggregation Trees — build_aggtree • aggTrees</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregation Trees — build_aggtree"><meta property="og:description" content="Nonparametric data-driven approach to discovering heterogeneous subgroups in a selection-on-observables framework.
The approach constructs a sequence of groupings, one for each level of granularity. Groupings are nested and
feature an optimality property. For each grouping, we obtain point estimation and standard errors for the group average
treatment effects (GATEs) using debiased machine learning procedures. Additionally, we assess whether systematic heterogeneity
is found by testing the hypotheses that the differences in the GATEs across all pairs of groups are zero. Finally, we investigate
the driving mechanisms of effect heterogeneity by computing the average characteristics of units in each group."><meta property="og:image" content="https://riccardo-df.github.io/aggTrees/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aggTrees</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/aggTrees-vignette.html">Get started</a>
</li>
<li>
  <a href="../articles/inference.html">Inference</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/riccardo-df/aggTrees" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregation Trees</h1>
    <small class="dont-index">Source: <a href="https://github.com/riccardo-df/aggTrees/blob/main/R/aggregation-trees.R" class="external-link"><code>R/aggregation-trees.R</code></a></small>
    <div class="hidden name"><code>build_aggtree.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Nonparametric data-driven approach to discovering heterogeneous subgroups in a selection-on-observables framework.
The approach constructs a sequence of groupings, one for each level of granularity. Groupings are nested and
feature an optimality property. For each grouping, we obtain point estimation and standard errors for the group average
treatment effects (GATEs) using debiased machine learning procedures. Additionally, we assess whether systematic heterogeneity
is found by testing the hypotheses that the differences in the GATEs across all pairs of groups are zero. Finally, we investigate
the driving mechanisms of effect heterogeneity by computing the average characteristics of units in each group.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build_aggtree</span><span class="op">(</span></span>
<span>  <span class="va">Y_tr</span>,</span>
<span>  <span class="va">D_tr</span>,</span>
<span>  <span class="va">X_tr</span>,</span>
<span>  Y_hon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  D_hon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  X_hon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cates_tr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cates_hon <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"aipw"</span>,</span>
<span>  scores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">inference_aggtree</span><span class="op">(</span><span class="va">object</span>, <span class="va">n_groups</span>, boot_ci <span class="op">=</span> <span class="cn">FALSE</span>, boot_R <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y-tr">Y_tr<a class="anchor" aria-label="anchor" href="#arg-y-tr"></a></dt>
<dd><p>Outcome vector for training sample.</p></dd>


<dt id="arg-d-tr">D_tr<a class="anchor" aria-label="anchor" href="#arg-d-tr"></a></dt>
<dd><p>Treatment vector for training sample.</p></dd>


<dt id="arg-x-tr">X_tr<a class="anchor" aria-label="anchor" href="#arg-x-tr"></a></dt>
<dd><p>Covariate matrix (no intercept) for training sample.</p></dd>


<dt id="arg-y-hon">Y_hon<a class="anchor" aria-label="anchor" href="#arg-y-hon"></a></dt>
<dd><p>Outcome vector for honest sample.</p></dd>


<dt id="arg-d-hon">D_hon<a class="anchor" aria-label="anchor" href="#arg-d-hon"></a></dt>
<dd><p>Treatment vector for honest sample.</p></dd>


<dt id="arg-x-hon">X_hon<a class="anchor" aria-label="anchor" href="#arg-x-hon"></a></dt>
<dd><p>Covariate matrix (no intercept) for honest sample.</p></dd>


<dt id="arg-cates-tr">cates_tr<a class="anchor" aria-label="anchor" href="#arg-cates-tr"></a></dt>
<dd><p>Optional, predicted CATEs for honest sample. If not provided by the user, CATEs are estimated internally via a <code><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">causal_forest</a></code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Either <code>"raw"</code> or <code>"aipw"</code>, controls how node predictions are computed.</p></dd>


<dt id="arg-scores">scores<a class="anchor" aria-label="anchor" href="#arg-scores"></a></dt>
<dd><p>Optional, vector of scores to be used in computing node predictions. Useful to save computational time if scores have already been estimated. Ignored if <code>method == "raw"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments from <code><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html" class="external-link">rpart.control</a></code>.</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An <code>aggTrees</code> object.</p></dd>


<dt id="arg-n-groups">n_groups<a class="anchor" aria-label="anchor" href="#arg-n-groups"></a></dt>
<dd><p>Number of desired groups.</p></dd>


<dt id="arg-boot-ci">boot_ci<a class="anchor" aria-label="anchor" href="#arg-boot-ci"></a></dt>
<dd><p>Logical, whether to compute bootstrap confidence intervals.</p></dd>


<dt id="arg-boot-r">boot_R<a class="anchor" aria-label="anchor" href="#arg-boot-r"></a></dt>
<dd><p>Number of bootstrap replications. Ignored if <code>boot_ci == FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>build_aggtree</code> returns an <code>aggTrees</code> object.<br></p>
<p><code>inference_aggtree</code> returns an <code>aggTrees.inference</code> object, which in turn contains the <code>aggTrees</code> object used
in the call.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Aggregation trees are a three-step procedure. First, the conditional average treatment effects (CATEs) are estimated using any
estimator. Second, a tree is grown to approximate the CATEs. Third, the tree is pruned to derive a nested sequence of optimal
groupings, one for each granularity level. For each level of granularity, we can obtain point estimation and inference about
the GATEs.<br></p>
<p>To implement this methodology, the user can rely on two core functions that handle the various steps.<br></p><div class="section">
<h3 id="constructing-the-sequence-of-groupings">Constructing the Sequence of Groupings<a class="anchor" aria-label="anchor" href="#constructing-the-sequence-of-groupings"></a></h3>


<p><code>build_aggtree</code> constructs the sequence of groupings (i.e., the tree) and estimate the GATEs in each node. The
GATEs can be estimated in several ways. This is controlled by the <code>method</code> argument. If <code>method == "raw"</code>, we
compute the difference in mean outcomes between treated and control observations in each node. This is an unbiased estimator
in randomized experiment. If <code>method == "aipw"</code>, we construct doubly-robust scores and average them in each node. This
is unbiased also in observational studies. Honest regression forests and 5-fold cross fitting are used to estimate the
propensity score and the conditional mean function of the outcome (unless the user specifies the argument <code>scores</code>).<br></p>
<p>The user can provide a vector of the estimated CATEs via the <code>cates_tr</code> and <code>cates_hon</code> arguments. If no CATEs are provided,
these are estimated internally via a <code><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">causal_forest</a></code> using only the training sample, that is, <code>Y_tr</code>, <code>D_tr</code>,
and <code>X_tr</code>.<br></p>
</div>

<div class="section">
<h3 id="gates-estimation-and-inference">GATEs Estimation and Inference<a class="anchor" aria-label="anchor" href="#gates-estimation-and-inference"></a></h3>


<p><code>inference_aggtree</code> takes as input an <code>aggTrees</code> object constructed by <code>build_aggtree</code>. Then, for
the desired granularity level, chosen via the <code>n_groups</code> argument, it provides point estimation and standard errors for
the GATEs. Additionally, it performs some hypothesis testing to assess whether we find systematic heterogeneity and computes
the average characteristics of the units in each group to investigate the driving mechanisms.</p><div class="section">
<h4 id="point-estimates-and-standard-errors-for-the-gates">Point estimates and standard errors for the GATEs<a class="anchor" aria-label="anchor" href="#point-estimates-and-standard-errors-for-the-gates"></a></h4>


<p>GATEs and their standard errors are obtained by fitting an appropriate linear model. If <code>method == "raw"</code>, we estimate
via OLS the following:</p>
<p>$$Y_i = \sum_{l = 1}^{|T|} L_{i, l} \gamma_l + \sum_{l = 1}^{|T|} L_{i, l} D_i \beta_l + \epsilon_i$$</p>
<p>with <code>L_{i, l}</code> a dummy variable equal to one if the i-th unit falls in the l-th group, and |T| the
number of groups. If the treatment is randomly assigned, one can show that the betas identify the GATE of
each group. However, this is not true in observational studies due to selection into treatment. In this case, the user is
expected to use <code>method == "aipw"</code> when calling <code>build_aggtree</code>. In this case,
<code>inference_aggtree</code> uses the scores in the following regression:</p>
<p>$$score_i = \sum_{l = 1}^{|T|} L_{i, l} \beta_l + \epsilon_i$$</p>
<p>This way, betas again identify the GATEs.<br></p>
<p>Regardless of <code>method</code>, standard errors are estimated via the Eicker-Huber-White estimator.<br></p>
<p>If <code>boot_ci == TRUE</code>, the routine also computes asymmetric bias-corrected and accelerated 95% confidence intervals using 2000 bootstrap
samples. Particularly useful when the honest sample is small-ish.</p>
</div>

<div class="section">
<h4 id="hypothesis-testing">Hypothesis testing<a class="anchor" aria-label="anchor" href="#hypothesis-testing"></a></h4>


<p><code>inference_aggtree</code> uses the standard errors obtained by fitting the linear models above to test the hypotheses
that the GATEs are different across all pairs of leaves. Here, we adjust p-values to account for multiple hypotheses testing
using Holm's procedure.</p>
</div>

<div class="section">
<h4 id="average-characteristics">Average Characteristics<a class="anchor" aria-label="anchor" href="#average-characteristics"></a></h4>


<p><code>inference_aggtree</code> regresses each covariate on a set of dummies denoting group membership. This way, we get the
average characteristics of units in each leaf, together with a standard error. Leaves are ordered in increasing order of their
predictions (from most negative to most positive). Standard errors are estimated via the Eicker-Huber-White estimator.</p>
</div>


</div>

<div class="section">
<h3 id="caution-on-inference">Caution on Inference<a class="anchor" aria-label="anchor" href="#caution-on-inference"></a></h3>


<p>Regardless of the chosen <code>method</code>, both functions estimate the GATEs, the linear models, and the average characteristics
of units in each group using only observations in the honest sample. If the honest sample is empty (this happens when the
user either does not provide <code>Y_hon</code>, <code>D_hon</code>, and <code>X_hon</code> or sets them to <code>NULL</code>), the same data used to
construct the tree are used to estimate the above quantities. This is fine for prediction but invalidates inference.</p>
</div>

    </div>
    <div id="references">
    <h2>References</h2>

<ul><li><p>Di Francesco, R. (2022). Aggregation Trees. CEIS Research Paper, 546. <a href="https://doi.org/10.2139/ssrn.4304256" class="external-link">doi:10.2139/ssrn.4304256</a>
.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.aggTrees.html">plot.aggTrees</a></code> <code><a href="print.aggTrees.inference.html">print.aggTrees.inference</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Riccardo Di Francesco</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Generate data.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1986</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">mu0</span> <span class="op">+</span> <span class="va">D</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu1</span> <span class="op">-</span> <span class="va">mu0</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Training-honest sample split.</span></span></span>
<span class="r-in"><span><span class="va">honest_frac</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">splits</span> <span class="op">&lt;-</span> <span class="fu"><a href="sample_split.html">sample_split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, training_frac <span class="op">=</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">honest_frac</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">training_idx</span> <span class="op">&lt;-</span> <span class="va">splits</span><span class="op">$</span><span class="va">training_idx</span></span></span>
<span class="r-in"><span><span class="va">honest_idx</span> <span class="op">&lt;-</span> <span class="va">splits</span><span class="op">$</span><span class="va">honest_idx</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Y_tr</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">training_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">D_tr</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">training_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">X_tr</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">training_idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Y_hon</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">honest_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">D_hon</span> <span class="op">&lt;-</span> <span class="va">D</span><span class="op">[</span><span class="va">honest_idx</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">X_hon</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="va">honest_idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Construct sequence of groupings. CATEs estimated internally.</span></span></span>
<span class="r-in"><span><span class="va">groupings</span> <span class="op">&lt;-</span> <span class="fu">build_aggtree</span><span class="op">(</span><span class="va">Y_tr</span>, <span class="va">D_tr</span>, <span class="va">X_tr</span>, <span class="va">Y_hon</span>, <span class="va">D_hon</span>, <span class="va">X_hon</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Alternatively, we can estimate the CATEs and pass them.</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/grf-labs/grf" class="external-link">grf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/grf/man/causal_forest.html" class="external-link">causal_forest</a></span><span class="op">(</span><span class="va">X_tr</span>, <span class="va">Y_tr</span>, <span class="va">D_tr</span><span class="op">)</span> <span class="co"># Use training sample.</span></span></span>
<span class="r-in"><span><span class="va">cates_tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest</span>, <span class="va">X_tr</span><span class="op">)</span><span class="op">$</span><span class="va">predictions</span></span></span>
<span class="r-in"><span><span class="va">cates_hon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">forest</span>, <span class="va">X_hon</span><span class="op">)</span><span class="op">$</span><span class="va">predictions</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">groupings</span> <span class="op">&lt;-</span> <span class="fu">build_aggtree</span><span class="op">(</span><span class="va">Y_tr</span>, <span class="va">D_tr</span>, <span class="va">X_tr</span>, <span class="va">Y_hon</span>, <span class="va">D_hon</span>, <span class="va">X_hon</span>, cates_tr <span class="op">=</span> <span class="va">cates_tr</span>, cates_hon <span class="op">=</span> <span class="va">cates_hon</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We have compatibility with generic S3-methods.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honest estimates: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rpart::rpart(formula = cates ~ ., data = data.frame(cates = cates_tr, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     X_tr), method = "anova", model = TRUE, control = rpart::rpart.control(...))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n= 500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          CP nsplit  rel error     xerror        xstd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.7360461      0 1.00000000 1.00439191 0.039833578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.1943360      1 0.26395392 0.27021335 0.012105034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.0218754      2 0.06961795 0.08064756 0.006947625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.0100000      3 0.04774255 0.05108766 0.003389573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variable importance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x2 x1 x3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94  5  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 1: 500 observations,    complexity param=0.7360461</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-0.1271354, MSE=0.6493231 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   left son=2 (221 obs) right son=3 (279 obs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Primary splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x2 &lt; -0.1879849 to the left,  improve=0.736046100, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; -0.2090187 to the left,  improve=0.040496860, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; 0.07957051 to the right, improve=0.005618913, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Surrogate splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; -0.2090187 to the left,  agree=0.588, adj=0.068, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; -2.778503  to the left,  agree=0.562, adj=0.009, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 2: 221 observations,    complexity param=0.0218754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-1.364316, MSE=0.06229607 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   left son=4 (190 obs) right son=5 (31 obs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Primary splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x2 &lt; -0.383392  to the left,  improve=0.5158625, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; -0.7607663 to the left,  improve=0.1757891, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; -0.6784445 to the right, improve=0.0194642, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 3: 279 observations,    complexity param=0.194336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=0.6772359, MSE=0.2578074 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   left son=6 (160 obs) right son=7 (119 obs)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Primary splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x2 &lt; 0.6613496  to the left,  improve=0.87717150, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; 0.5527987  to the right, improve=0.02474377, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; -0.6991158 to the left,  improve=0.02013863, (0 missing)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Surrogate splits:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x1 &lt; 1.289389   to the left,  agree=0.584, adj=0.025, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       x3 &lt; 2.15878    to the left,  agree=0.581, adj=0.017, (0 split)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 4: 190 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-1.509075, MSE=0.02885161 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 5: 31 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=-0.320842, MSE=0.03817818 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 6: 160 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=0.06742149, MSE=0.03096881 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Node number 7: 119 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean=1.477908, MSE=0.0326036 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Honest estimates: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> n= 500 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> node), split, n, deviance, yval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       * denotes terminal node</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1) root 500 324.661600 -0.12713540  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2) x2&lt; -0.1879849 221  13.767430 -1.36431600  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4) x2&lt; -0.383392 190   5.481807 -1.50907500 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5) x2&gt;=-0.383392 31   1.183523 -0.32084200 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3) x2&gt;=-0.1879849 279  71.928260  0.67723590  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6) x2&lt; 0.6613496 160   4.955010  0.06742149 *</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7) x2&gt;=0.6613496 119   3.879829  1.47790800 *</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">)</span> <span class="co"># Try also setting 'sequence = TRUE'.</span></span></span>
<span class="r-plt img"><img src="build_aggtree-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To predict, do the following.</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="subtree.html">subtree</a></span><span class="op">(</span><span class="va">groupings</span><span class="op">$</span><span class="va">tree</span>, cv <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Select by cross-validation.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">X_hon</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1           2           3           4           5           6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.32084200 -1.50907485 -1.50907485  1.47790823 -1.50907485  0.06742149 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Inference with 4 groups.</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">inference_aggtree</span><span class="op">(</span><span class="va">groupings</span>, n_groups <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">model</span><span class="op">)</span> <span class="co"># Coefficient of leafk is GATE in k-th leaf.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> estimatr::lm_robust(formula = scores ~ 0 + leaf, data = data.frame(scores = scores, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     leaf = leaves), se_type = "HC1")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard error type:  HC1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper  DF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf1 -1.50907     0.1717 -8.7904 2.454e-17  -1.8464  -1.1718 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf2 -0.32084     0.3778 -0.8492 3.962e-01  -1.0632   0.4215 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf3  0.06742     0.1576  0.4277 6.690e-01  -0.2423   0.3771 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf4  1.47791     0.1870  7.9046 1.754e-14   1.1106   1.8453 496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multiple R-squared:  0.2305 ,	Adjusted R-squared:  0.2243 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> F-statistic: 35.16 on 4 and 496 DF,  p-value: &lt; 2.2e-16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">gates_diff_pairs</span><span class="op">$</span><span class="va">gates_diff</span> <span class="co"># GATEs differences.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          leaf1     leaf2    leaf3 leaf4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf1       NA        NA       NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf2 1.188233        NA       NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf3 1.576496 0.3882635       NA    NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> leaf4 2.986983 1.7987502 1.410487    NA</span>
<span class="r-in"><span><span class="va">results</span><span class="op">$</span><span class="va">gates_diff_pairs</span><span class="op">$</span><span class="va">holm_pvalues</span> <span class="co"># leaves 1-2 not statistically different.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]        [,2]         [,3] [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]           NA          NA           NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 8.743913e-03          NA           NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 1.893241e-10 3.43402e-01           NA   NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 1.378481e-27 7.12634e-05 5.663583e-08   NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## LATEX.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span>, table <span class="op">=</span> <span class="st">"diff"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \begingroup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \setlength{\tabcolsep}{8pt}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \renewcommand{\arraystretch}{1.2}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \begin{table}[b!]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \centering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{adjustbox}{width = 1\textwidth}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{tabular}{@{\extracolsep{5pt}}l c c c c}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; \textit{Leaf 1} &amp; \textit{Leaf 2} &amp; \textit{Leaf 3} &amp; \textit{Leaf 4} \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[2pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \multirow{3}{*}{GATEs} &amp; -1.509 &amp; -0.321 &amp;  0.067 &amp;  1.478 \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; [-1.846, -1.172] &amp; [-1.062,  0.420] &amp; [-0.243,  0.377] &amp; [ 1.111,  1.845] \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; \{NA, NA\} &amp; \{NA, NA\} &amp; \{NA, NA\} &amp; \{NA, NA\} \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[2pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 1} &amp; NA &amp; NA &amp; NA &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (NA) &amp; (NA) &amp; (NA) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 2} &amp; 1.19 &amp;   NA &amp;   NA &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (0.009) &amp; (   NA) &amp; (   NA) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 3} &amp; 1.58 &amp; 0.39 &amp;   NA &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (0.000) &amp; (0.343) &amp; (   NA) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \textit{Leaf 4} &amp; 2.99 &amp; 1.80 &amp; 1.41 &amp; NA \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &amp; (0.000) &amp; (0.000) &amp; (0.000) &amp; (NA) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[3pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{tabular}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{adjustbox}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \caption{Point estimates and $95\%$ confidence intervals for the GATEs based on asymptotic normality (in square brackets) and on the percentiles of the bootstrap distribution (in curly braces). Leaves are sorted in increasing order of the GATEs. Additionally, the GATE differences across all pairs of leaves are displayed. $p$-values testing the null hypothesis that a single difference is zero are adjusted using Holm's procedure and reported in parenthesis under each point estimate.}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \label{table_differences_gates}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{table}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \endgroup </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span>, table <span class="op">=</span> <span class="st">"avg_char"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \begingroup</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \setlength{\tabcolsep}{8pt}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \renewcommand{\arraystretch}{1.1}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   \begin{table}[b!]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \centering</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{adjustbox}{width = 1\textwidth}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \begin{tabular}{@{\extracolsep{5pt}}l c c c c c c c c }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; \multicolumn{2}{c}{\textit{Leaf 1}} &amp; \multicolumn{2}{c}{\textit{Leaf 2}} &amp; \multicolumn{2}{c}{\textit{Leaf 3}} &amp; \multicolumn{2}{c}{\textit{Leaf 4}} \\\cmidrule{2-3} \cmidrule{4-5} \cmidrule{6-7} \cmidrule{8-9} </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       &amp; Mean &amp; (S.E.) &amp; Mean &amp; (S.E.) &amp; Mean &amp; (S.E.) &amp; Mean &amp; (S.E.) \\</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[2pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \texttt{x1} &amp; -0.018 &amp; (0.073) &amp; -0.041 &amp; (0.188) &amp;  0.001 &amp; (0.078) &amp; -0.029 &amp; (0.082) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \texttt{x2} &amp; -1.056 &amp; (0.044) &amp; -0.299 &amp; (0.012) &amp;  0.207 &amp; (0.018) &amp;  1.286 &amp; (0.046) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \texttt{x3} &amp;  0.043 &amp; (0.075) &amp; -0.136 &amp; (0.198) &amp; -0.156 &amp; (0.079) &amp;  0.050 &amp; (0.085) \\ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \addlinespace[3pt]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \\[-1.8ex]\hline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       \hline \\[-1.8ex]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{tabular}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{adjustbox}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \caption{Average characteristics of units in each leaf, obtained by regressing each covariate on a set of dummies denoting leaf membership . Standard errors are estimated via the Eicker-Huber-White estimator. Leaves are sorted in increasing order of the GATEs.}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \label{table_average_characteristics_leaves}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     \end{table}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> \endgroup </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Riccardo Di Francesco.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

